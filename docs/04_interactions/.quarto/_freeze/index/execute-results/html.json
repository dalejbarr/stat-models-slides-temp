{
  "hash": "1698027a5dbce0b851b5640c99f58817",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Stat Models (03): Interactions\"\nauthor: \"Dale Barr\"\ninstitute: University of Glasgow\ntitle-slide-attributes:\n  data-background-image: \"img/titlescreen.png\"\nformat: \n  revealjs:\n    theme: dark \n    code-line-numbers: false\n    chalkboard: true\n    df-print: tibble\nknitr:\n  opts_chunk:\n    echo: false\n---\n\n\n\n\n\n# \n\n\"It depends.\"\n\n*The effect of a predictor variable on the response variable may depend upon\nthe value(s) of one or more other predictor variables.*\n\n## Continuous-by-Categorical Interactions\n\n**Do stronger people tend to have lower voices?**\n\n::: aside\nHan, C., Wang, H., Fasolt, V., Hahn, A. C., Holzleitner, I. J., Lao, J., DeBruine, L. M., Feinberg, D. R., & Jones, B. C. (2018). [No evidence for correlations between handgrip strength and sexually dimorphic acoustic properties of voices.](https://doi.org/10.1002/ajhb.23178). *American Journal of Human Biology*, *30*, e23178.\n\nData: <https://osf.io/na6be/>\n:::\n\n## The Data\n\n\n\n::: {.cell df-print='tibble'}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 221 × 4\n      ID sex     HGS    F0\n   <int> <chr> <dbl> <dbl>\n 1     4 male   45.5 115. \n 2     7 male   31   147. \n 3     8 male   40   123. \n 4    19 male   37   120. \n 5    21 male   45    94.7\n 6    22 male   50    98.8\n 7    30 male   31    94.7\n 8    31 male   47.5 124. \n 9    35 male   34    92.6\n10    36 male   30   111. \n# ℹ 211 more rows\n```\n\n\n:::\n:::\n\n\n\n::: aside\n`HGS`: Hand grip strength, `F0`: voice fundamental frequency\n:::\n\n---\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n\n---\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = HGS ~ F0, data = hgs)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-23.408  -4.115  -0.161   4.252  34.157 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 56.699687   1.491239   38.02   <2e-16 ***\nF0          -0.144729   0.008509  -17.01   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.008 on 219 degrees of freedom\nMultiple R-squared:  0.5692,\tAdjusted R-squared:  0.5672 \nF-statistic: 289.3 on 1 and 219 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n---\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n\n---\n\n$$HGS_i = \\beta_0 + \\beta_1 F0_i + \\beta_2 SEX_i + \\beta_3 F0_i SEX_i + e_i$$\n\n$$= \\beta_0 + \\beta_2 SEX_i + (\\beta_1 + \\beta_3 SEX_i) F0_i + e_i$$\n\n::: {.r-stack}\n`HGS ~ F0 + sex + F0:sex`\n:::\n\n::: {.r-stack}\n`HGS ~ F0 * sex`\n:::\n\n- `SEX`: 0 = female, 1 = male\n\n- female: $\\beta_0 + \\beta_1 F0_i$\n- male: $\\beta_0 + \\beta_2 + (\\beta_1 + \\beta_3) F0_i$\n\n## Dummy Coding\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  sex    sex_male\n  <chr>     <dbl>\n1 male          1\n2 female        0\n```\n\n\n:::\n:::\n\n\n\n## Analysis\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = HGS ~ sex_male * F0, data = hgs2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-21.859  -3.540  -0.421   3.361  33.163 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 29.75789    6.50985   4.571 8.14e-06 ***\nsex_male    15.91254    7.87733   2.020   0.0446 *  \nF0          -0.02508    0.02965  -0.846   0.3985    \nsex_male:F0 -0.01642    0.04847  -0.339   0.7351    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.643 on 217 degrees of freedom\nMultiple R-squared:  0.6163,\tAdjusted R-squared:  0.611 \nF-statistic: 116.2 on 3 and 217 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n# Categorical-by-Categorical Interactions\n  \n## Factorial designs\n\n- Used to address a question involving more than one factor that can influence a DV, with each factor acting alone *or in combination with other factors*\n\n  - What are the effects of cognitive therapy and drug therapy on mood\n    in depressed individuals?\n  - Do male and female students learn better with male or female\n    teachers?\n\n## Full Factorial Designs\n\n- A study has a full factorial design if it has more than one IV and\n  the levels of the IVs are \"fully crossed\"\n- designs are designated using RxC (row-by-column) format\n- *cell:* unique combination of the levels of the factors\n\n![](img/factorial.png){fig-align=\"center\"}\n\n## Factorial Plots and Interpretation\n\n![](img/scenarios.png){fig-align=\"center\"}\n\n## Effects in Factorial Designs\n\n- Main Effects: tests of /marginal means/\n    - $H_0: \\mu_{A_1} = \\mu_{A_2}$\n    - $H_0: \\mu_{B_1} = \\mu_{B_2}$\n\n- Simple Effects: effect of factor at level of other\n    - eff of $B$ at $A_1$, $H_0: \\mu_{A_1B_1} = \\mu_{A_1B_2}$\n    - eff of $B$ at $A_2$, $H_0: \\mu_{A_2B_1} = \\mu_{A_2B_2}$\n\n- Interaction: equivalence of simple effects\n    - $H_0: \\mu_{A_1B_2}-\\mu_{A_1B_1} = \\mu_{A_2B_2}-\\mu_{A_2B_1}$\n\n## A fallacy\n\n> \"The percentage of neurons showing cue-related activity increased with training in the mutant mice ($p < 0.05$), but not in the control mice ($p > 0.05$).\"\n\nSaying the simple effect is significant in one case but not in another does not imply that the simple effects are statistically different!\n\n::: aside\nGelman, A., & Stern, H. (2012). [The difference between \"significant\" and \"not significant\" is not itself statistically significant.](https://amstat.tandfonline.com/doi/abs/10.1198/000313006X152649#.XbAog_fTXeQ) *The American Statistician*, *60*, 328--331.\n\nNieuwenhuis, S., Forstmann, B. U., & Wagenmakers, E. J. (2011). [Erroneous analyses of interactions in neuroscience: a problem of significance.](https://www.nature.com/articles/nn.2886?draft=collection) *Nature Neuroscience*, *14*, 1105-1107.\n:::\n\n# Coding categorical predictors\n\n---\n\n::: {.r-stack}\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Scheme            |          $A_1$|         $A_2$|\n|:-----------------|--------------:|-------------:|\n|Treatment (dummy) |            $0$|           $1$|\n|Sum               |           $-1$|           $1$|\n|Deviation         | $-\\frac{1}{2}$| $\\frac{1}{2}$|\n\n\n:::\n:::\n\n\n:::\n\nChoice of a coding scheme impacts interpretation of:\n\n1. the intercept term; and\n2. the interpretation of the tests for all but the highest-order effects and interactions in a factorial design.\n\n## {.smaller}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n| term  |                              treatment                              |                                      sum                                      |                              deviation                              |\n|:-----:|:-------------------------------------------------------------------:|:-----------------------------------------------------------------------------:|:-------------------------------------------------------------------:|\n| $\\mu$ |                           $\\bar{Y}_{111}$                           |                                $\\bar{Y}_{...}$                                |                           $\\bar{Y}_{...}$                           |\n|  $A$  |                   $\\bar{Y}_{211} - \\bar{Y}_{111}$                   |                  $\\frac{(\\bar{Y}_{2..} - \\bar{Y}_{1..})}{2}$                  |                   $\\bar{Y}_{2..} - \\bar{Y}_{1..}$                   |\n|  $B$  |                   $\\bar{Y}_{121} - \\bar{Y}_{111}$                   |                  $\\frac{(\\bar{Y}_{.2.} - \\bar{Y}_{.1.})}{2}$                  |                   $\\bar{Y}_{.2.} - \\bar{Y}_{.1.}$                   |\n|  $C$  |                   $\\bar{Y}_{112} - \\bar{Y}_{111}$                   |                  $\\frac{(\\bar{Y}_{..2} - \\bar{Y}_{..1})}{2}$                  |                   $\\bar{Y}_{..2} - \\bar{Y}_{..1}$                   |\n| $AB$  | $(\\bar{Y}_{221} - \\bar{Y}_{121}) - (\\bar{Y}_{211} - \\bar{Y}_{111})$ | $\\frac{(\\bar{Y}_{22.} - \\bar{Y}_{12.}) - (\\bar{Y}_{21.} - \\bar{Y}_{11.})}{4}$ | $(\\bar{Y}_{22.} - \\bar{Y}_{12.}) - (\\bar{Y}_{21.} - \\bar{Y}_{11.})$ |\n| $AC$  | $(\\bar{Y}_{212} - \\bar{Y}_{211}) - (\\bar{Y}_{112} - \\bar{Y}_{111})$ | $\\frac{(\\bar{Y}_{2.2} - \\bar{Y}_{1.2}) - (\\bar{Y}_{2.1} - \\bar{Y}_{1.1})}{4}$ | $(\\bar{Y}_{2.2} - \\bar{Y}_{1.2}) - (\\bar{Y}_{2.1} - \\bar{Y}_{1.1})$ |\n| $BC$  | $(\\bar{Y}_{122} - \\bar{Y}_{112}) - (\\bar{Y}_{121} - \\bar{Y}_{111})$ | $\\frac{(\\bar{Y}_{.22} - \\bar{Y}_{.12}) - (\\bar{Y}_{.21} - \\bar{Y}_{.11})}{4}$ | $(\\bar{Y}_{.22} - \\bar{Y}_{.12}) - (\\bar{Y}_{.21} - \\bar{Y}_{.11})$ |\n\n\n:::\n:::\n\n\n\n## More than 2 levels ($k > 2$)?\n\nArbitrarily choose one as \"baseline\".\n\n:::: {.panel-tabset}\n\n### Dummy ($k = 3$)\n\n:::: {.panel-tabset}\n\n#### scheme\n\n|       | `A2v1` | `A3v1` |\n|:------|-------:|-------:|\n| $A_1$ |      0 |      0 |\n| $A_2$ |      1 |      0 |\n| $A_3$ |      0 |      1 |\n\n#### code\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::::\n\n### Deviation ($k = 3$)\n\n:::: {.panel-tabset}\n\n#### scheme\n\n|       |    `A2v1`      | `A3v1`         |\n|:------|---------------:|---------------:|\n| $A_1$ | $-\\frac{1}{3}$ | $-\\frac{1}{3}$ |\n| $A_2$ | $\\frac{2}{3}$  | $-\\frac{1}{3}$ |\n| $A_3$ | $-\\frac{1}{3}$ | $\\frac{2}{3}$  |\n\n#### code\n\ntarget level: $\\frac{k - 1}{k}$, otherwise: $-\\frac{1}{k}$\n\n\n\n::: {.cell}\n\n:::\n\n\n\n::::\n\n::::\n\n## Linear Model Formulas in R\n\n::: {.r-stack}\n`y ~ a * b * c`\n:::\n\n::: {.r-stack}\nis shorthand for\n:::\n\n::: {.r-stack}\n`y ~ a + b + c + a:b + a:c + b:c + a:b:c`\n:::\n\n---\n\n::: {.r-stack}\nwhen factor $A$ has 3 levels: \n:::\n\n::: {.r-stack}\n`y ~ (a1 + a2) * b`\n:::\n\n::: {.r-stack}\nis shorthand for\n:::\n\n::: {.r-stack}\n`y ~ a1 + a2 + b + a1:b + a2:b`\n:::\n\n---\n\n::: {.r-stack}\nwhen $A$ and $B$ have 3 levels:\n:::\n\n::: {.r-stack}\n`y ~ (a1 + a2) * (b1 + b2)`\n:::\n\n::: {.r-stack}\nis shorthand for\n:::\n\n::: {.r-stack}\n`y ~ a1 + a2 + b1 + b2 + a1:b1 + a1:b2 + a2:b1 + a2:b2`\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}